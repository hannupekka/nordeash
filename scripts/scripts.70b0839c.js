"use strict";angular.module("nordeashApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("nordeashApp").controller("MainCtrl",["$scope",function(a){a.upload=function(a){console.log(a.target.files[0]),c("csvFile",b)},a.timeInterval=[];var b=function(b){a.timeInterval.push(b[1].date),a.timeInterval.push(b[b.length-1].date);var c=[];b=_.groupBy(b,function(a){return a.target}),_.map(b,function(a,b){c.push({id:b,length:a.length,sum:Math.round(_.reduce(a,function(a,b){var c=-1*parseFloat(b.sum.replace(",","."));return c>0?a+c:a},0))})}),c=_.sortBy(c,function(a){return a.sum}).reverse(),c=_.map(c,function(a){return a.percentage=Math.round(a.sum/c[0].sum*100),a}),a.total=_.reduce(c,function(a,b){return a+parseInt(b.sum)},0),a.summary=c,console.log(c)},c=function(a,b){var c=document.getElementById(a),d=/^([a-zA-Z0-9\s_\\.\-:])+(.csv|.txt)$/,e='(	(?=(?:(?:[^"]*"){2})*[^"]*$))',f=new RegExp(e,"g");if(d.test(c.value.toLowerCase()))if("undefined"!=typeof FileReader){var g=new FileReader;g.onload=function(a){for(var c=[],d=a.target.result.split("\n"),e=2;e<d.length;e++){d[e]=d[e].replace(f,"{;}");var g=d[e].split("{;}").slice(0,5);g[0]&&g[3]&&c.push({date:g[0],sum:g[3],target:g[4]})}b(c)},g.readAsText(c.files[0])}else alert("This browser does not support HTML5.");else alert("Please upload a valid CSV file.")}}]).directive("customOnChange",function(){return{restrict:"A",link:function(a,b,c){var d=b.scope()[c.customOnChange];b.bind("change",d)}}}),angular.module("nordeashApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);