"use strict";angular.module("nordeashApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("nordeashApp").controller("MainCtrl",["$scope","$timeout",function(a,b){a.loading=!1,a.upload=function(b){a.loading=!0,d("csvFile",c)},a.timeInterval=[];var c=function(c){a.timeInterval.push(c[1].date),a.timeInterval.push(c[c.length-1].date);var d=[];c=_.groupBy(c,function(a){return a.target}),_.map(c,function(a,b){d.push({id:b,length:a.length,percentage:0,sum:Math.round(_.reduce(a,function(a,b){var c=-1*parseFloat(b.sum.replace(",","."));return c>0?a+c:a},0))})}),d=_.sortBy(d,function(a){return a.sum}).reverse(),a.total=_.reduce(d,function(a,b){return a+parseInt(b.sum)},0),a.summary=d,b(function(){a.summary=_.map(a.summary,function(a){return a.percentage=Math.round(a.sum/d[0].sum*100),a}),a.loading=!1},4e3)},d=function(b,c){a.loading=!0;var d=document.getElementById(b),e=/^([a-zA-Z0-9\s_\\.\-:])+(.csv|.txt)$/,f='(	(?=(?:(?:[^"]*"){2})*[^"]*$))',g=new RegExp(f,"g");if(e.test(d.value.toLowerCase()))if("undefined"!=typeof FileReader){var h=new FileReader;h.onload=function(a){for(var b=[],d=a.target.result.split("\n"),e=2;e<d.length;e++){d[e]=d[e].replace(g,"{;}");var f=d[e].split("{;}").slice(0,5);f[0]&&f[3]&&b.push({date:f[0],sum:f[3],target:f[4]})}c(b)},h.readAsText(d.files[0])}else alert("This browser does not support HTML5."),a.loading=!1;else alert("Please upload a valid CSV file."),a.loading=!1}}]).directive("customOnChange",function(){return{restrict:"A",link:function(a,b,c){var d=b.scope()[c.customOnChange];b.bind("change",d)}}}),angular.module("nordeashApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);